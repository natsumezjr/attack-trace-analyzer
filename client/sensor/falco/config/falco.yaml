# Falco config template
#
# Goal for this project:
# - Produce *JSON* alerts
# - Load only ATA custom rules (disable default noisy rules)
# - Write to a file path that can be consumed by falco-ecs (./data mount)
#
# Reference:
# - Falco docs: JSON output and file_output options.

# Keep stdout on for quick debugging (`docker logs ata-falco`)
stdout_output:
  enabled: true

# Only load our curated ruleset (do NOT load default falco_rules.yaml).
rules_files:
  - /etc/falco/rules.d/ata_telemetry_rules.yaml

# Output JSON (instead of plain text)
json_output: true

# Optional: include the `output` field inside JSON
json_include_output_property: true

# Also write to a file for easy consumption by client-backend
file_output:
  enabled: true
  filename: /data/falco.jsonl
  keep_alive: false
