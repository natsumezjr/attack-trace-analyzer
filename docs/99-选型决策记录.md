# 选型决策记录（Decision Log｜已最终拍板）

本文档用于把项目的关键“选型/口径”一次性写死，避免组员在实现与写报告时出现分歧。

## 1. 总体结论

- 核心存储/检索：**OpenSearch**
- 统一范式：**ECS v9.2.0**（事件统一写 `ecs.version=9.2.0`）
- 自定义字段：统一使用命名空间 **`ata.*`**
- 图谱：**Neo4j**（实体关系图的权威存储）
- 主机侧（Linux 为主）：
  - 主机日志：`auditd` + `auth.log`（SSH/sudo 等）
  - 主机行为：**Falco**（行为告警为主）
- 网络侧：
  - 事实日志：Zeek
  - 告警：Suricata
- 库内检测（Store-first）：**OpenSearch Security Analytics（Sigma 规则）**
- 源头检测（Detect-first）：保留（Falco/Suricata 直接告警）
- 告警融合：保留 `raw-findings-*`，并生成 `canonical-findings-*`（供串链使用）
- 攻击复现：**Atomic Red Team**
- 标准化导出：**ATT&CK Navigator layer**

## 2. 为什么这样选（给组员的 30 秒解释）

- OpenSearch：存“事实事件”和“告警/链路摘要”，便于按时间检索与聚合展示。
- Neo4j：专门做“多跳关系推理”（横向移动/路径重建）更直观、更适合演示图。
- ECS + `ata.*`：保证跨源字段一致，同时避免自定义字段与 ECS 冲突。
- Security Analytics：把 Sigma 规则直接跑在 `ecs-events-*` 上，产出带 ATT&CK 标注的告警（Findings）。
- Falco/Suricata：端侧直接产告警，出结果快，能为串链提供强信号。
- Atomic Red Team：按 ATT&CK technique 复现动作，确保演示可重复、可对照。
- Navigator layer：把“命中的 technique”标到矩阵上，PPT 展示效果强、实现成本低。

## 3. 明确不做（当前阶段不纳入范围）

- Caldera（多阶段自动编排）
- Attack Flow（结构化攻击链导出）
- Arkime（PCAP/会话回放增强）

