# 文档索引（新结构）

本目录 `docs/` 是本仓库的**正式文档集合**。

## 1. 文档原则（必须遵守）

1. **单一信息源**：同一主题只允许在一个文档里定义“权威口径”。其他文档只做引用，不得复制粘贴导致口径分叉。
2. **确定性**：本文档集合中不出现“多方案/分支方案/视情况”等不确定表述。所有默认值、边界条件与失败行为都必须写死。
3. **冲突处理**：迁移过程中发现“旧文档 ↔ 旧文档”或“旧文档 ↔ 代码”的矛盾，不在正文里打补丁解释，统一记入 `docs/冲突汇总.md`，迁移完毕后集中讨论。

## 2. 阅读路径（推荐）

1) 先看要求：`10-课程设计要求文档.md`
2) 再看需求：`20-整体需求文档.md`
3) 再看总体规格：`30-系统规格说明书.md`
4) 然后看模块规格：`31-OpenSearch模块规格说明书.md` / `32-Neo4j模块规格说明书.md` / `33-Analysis模块规格说明书.md`
5) 再看实现规格：`34-客户机规格说明书.md` / `35-中心机后端规格说明书.md`
6) 最后看数据与接口：`40-模块与数据流说明.md` / `50-数据库设计.md` / `51-ECS字段规范.md` / `52-实体图谱规范.md` / `53-环境变量规范.md` / `54-客户机-中心机接口规范.md`

## 3. 文档分工：每份文档写什么、不写什么

> 这部分是“防止文档打架”的核心。迁移过程中会持续补全到最终形态。

### 00-文档索引.md
- 写：文档目录、阅读路径、权威性与引用规则、冲突处理规则。
- 不写：任何模块细节、字段细节、接口细节。

### 10-课程设计要求文档.md
- 写：老师给定的题目、验收/提交要求、时间地点、硬性约束。
- 不写：任何系统设计、实现方案与技术细节。

### 20-整体需求文档.md
- 写：FR/NFR、范围边界、角色、验收标准。
- 不写：实现细节（算法实现、索引 mapping、Cypher、代码结构等）。

### 30-系统规格说明书.md
- 写：系统总体架构、核心流程、组件边界、调度与异步任务的总体机制。
- 不写：OpenSearch mapping 细表、Neo4j node/edge 细表、ECS 字段全量表、接口 request/response 的逐字段表。

### 31-OpenSearch模块规格说明书.md
- 写：索引体系、写入路由、Store-first 检测、Raw→Canonical 融合、保留策略与脚本。
- 不写：Neo4j 图谱细节、前端可视化细节、客户端采集细节。

### 32-Neo4j模块规格说明书.md
- 写：图存储边界、写入（ECS→Graph）、查询（可视化所需的图查询/最短路等）、结果承载方式（边属性）。
- 不写：OpenSearch 检测与索引策略、ECS 字段全量表。

### 33-Analysis模块规格说明书.md
- 写：溯源任务的异步模型、算法流水线、如何把分析结果写回 Neo4j 边属性、任务查询与结果展示口径。
- 不写：OpenSearch mapping 细表、客户端采集细节。

### 34-客户机规格说明书.md
- 写：客户机侧容器编排（7 个容器）、传感器组件（Falco / Filebeat / Suricata）、Go Backend 实现、ECS 转换规则、RabbitMQ 队列消费、部署与运维。
- 不写：中心机后端实现（去 35）、OpenSearch / Neo4j 内部逻辑（去 31/32）。

### 35-中心机后端规格说明书.md
- 写：FastAPI 应用结构与生命周期、API 路由组织（8 个路由模块）、在线靶机注册与轮询服务、与三大模块的集成方式、环境变量与配置。
- 不写：OpenSearch / Neo4j / Analysis 模块内部实现（去 31/32/33）、客户机侧实现（去 34）。

### 40-模块与数据流说明.md
- 写：端到端数据流故事线、数据分层（Telemetry/Findings/Graph）、每一步输入输出。
- 不写：字段与接口的逐字段细节（避免与 51/54 打架）。

### 50-数据库设计.md
- 写：全局数据对象、存储边界、保留策略、索引/图之间的关系与一致性策略。
- 不写：ECS 字段细节（去 51）、实体图谱细节（去 52）。

### 51-ECS字段规范.md
- 写：统一事件范式（ECS 子集）与 dataset 口径、必填字段、生成策略、三时间字段、Finding 结构。
- 不写：具体接口路径与鉴权（去 54）、Neo4j 图谱建模（去 52）。

### 52-实体图谱规范.md
- 写：节点/边类型、唯一键、边属性、抽取规则、与 51 的字段对齐关系。
- 不写：Neo4j 连接参数与运维（去 53/32）、OpenSearch 检测（去 31）。

### 53-环境变量规范.md
- 写：所有环境变量清单、默认值、作用域（client/backend/opensearch/neo4j）、加载与覆盖规则。
- 不写：任何功能需求或模块实现细节。

### 54-客户机-中心机接口规范.md
- 写：客户机侧对中心机侧暴露的接口、中心机轮询与鉴权、幂等与游标、错误码与重试策略。
- 不写：ECS 字段细节（去 51）、OpenSearch/Neo4j 内部实现细节（去 31/32）。

## 4. 冲突与不确定项

统一见：`docs/冲突汇总.md`。
