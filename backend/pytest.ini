[pytest]
cache_dir = ../.context/pytest_cache/backend

testpaths =
    tests

python_files = test_*.py
python_classes = Test*
python_functions = test_*

addopts =
    --strict-markers
    --tb=short
    --strict-config
    --cov=app
    --cov-report=term-missing
    --cov-report=html:htmlcov

markers =
    # Test layers
    unit: Unit tests (no external services, fast)
    integration: Integration tests (may require external services)
    e2e: End-to-end tests (complete business scenarios)
    system: System tests (multi-component workflows)

    # Speed markers
    slow: Slow tests (may take longer than 1 second)
    fast: Fast tests (less than 1 second)

    # External dependency markers
    requires_opensearch: Requires a running OpenSearch instance
    requires_neo4j: Requires a running Neo4j instance
    requires_llm: Requires LLM API access (OpenAI, etc.)

    # Module markers
    api: Tests for API routes
    opensearch: Tests for OpenSearch module
    neo4j: Tests for Neo4j module
    analyze: Tests for analysis module
    scheduler: Tests for scheduled tasks
