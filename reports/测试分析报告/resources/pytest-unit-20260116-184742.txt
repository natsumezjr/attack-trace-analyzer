ssssssssss.ssssssssssssssssssssssssssssssss                              [100%]
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.12.12-final-0 _______________

Name                                    Stmts   Miss Branch BrPart   Cover   Missing
------------------------------------------------------------------------------------
app/__init__.py                             0      0      0      0 100.00%
app/api/__init__.py                         0      0      0      0 100.00%
app/api/router.py                          13     13      0      0   0.00%   1-15
app/api/routes/__init__.py                  0      0      0      0 100.00%
app/api/routes/analysis_tasks.py          121    121     36      0   0.00%   1-269
app/api/routes/clients.py                  69     69      6      0   0.00%   1-143
app/api/routes/events.py                   65     65     22      0   0.00%   1-109
app/api/routes/findings.py                 68     68     24      0   0.00%   1-112
app/api/routes/graph.py                    88     88     36      0   0.00%   1-183
app/api/routes/health.py                    5      5      0      0   0.00%   1-8
app/api/routes/root.py                      5      5      0      0   0.00%   1-8
app/api/routes/targets.py                  61     61     14      0   0.00%   1-110
app/api/utils.py                           11     11      0      0   0.00%   1-22
app/core/__init__.py                        1      0      0      0 100.00%
app/core/config.py                         36     15     10      1  47.83%   9-11, 16-27
app/core/deps.py                            3      3      0      0   0.00%   1-5
app/core/logging.py                         3      3      0      0   0.00%   1-5
app/core/time.py                           47     39     24      0  11.27%   8, 12-14, 18-56, 60-63, 67
app/dto/__init__.py                         2      2      0      0   0.00%   1-3
app/dto/targets.py                          3      3      0      0   0.00%   1-5
app/schemas/__init__.py                     0      0      0      0 100.00%
app/schemas/common.py                       9      9      0      0   0.00%   1-15
app/services/analyze/__init__.py           82     72     26      0   9.26%   12-64, 80-122, 132-157
app/services/analyze/attack_fsa.py        316    205     92      0  27.21%   113-185, 201, 205, 209, 213, 217, 221, 230-231, 236, 241-244, 257-259, 263, 267, 283, 287, 292, 297, 319-334, 338, 342, 362-364, 368, 390-393, 397, 407-410, 415, 424, 428-431, 435-438, 449-455, 463-471, 495-566, 583-634, 650-676, 685-691, 709-726, 740-751, 760-770
app/services/analyze/killchain.py         646    512    294      0  14.26%   55-68, 220, 229-239, 244-246, 251-252, 260-268, 276-280, 392-394, 397, 400-407, 417-419, 474-487, 495-534, 555-611, 620-625, 634, 645-662, 689-699, 708-717, 725-729, 734-740, 749-758, 780-831, 849-904, 925-1034, 1051-1251, 1278-1290, 1304-1335, 1375-1431, 1443-1462, 1489-1537, 1548, 1553, 1574-1627
app/services/analyze/killchain_llm.py     278    237    104      0  10.73%   30, 78-80, 86, 89-159, 181, 184-208, 215-269, 281-334, 347-396, 405-420, 428-437, 469-474, 482-532, 543-545, 548-551, 569-636, 680-721
app/services/client_poller.py             165    129     30      0  18.46%   29-31, 35-36, 40-45, 49-54, 58-78, 82-96, 100, 120-121, 125-134, 143-162, 166-223, 228-232, 236-250, 255-264
app/services/neo4j/__init__.py              3      0      0      0 100.00%
app/services/neo4j/db.py                  534    482    184      0   7.24%   60-65, 70-74, 80-84, 90-126, 156-159, 187-202, 232-242, 253-255, 260-272, 287-301, 306-337, 365-396, 422-441, 480-489, 510-518, 523-534, 546-559, 564-577, 589-619, 624-632, 641-654, 659-666, 687-715, 724-742, 747-757, 768-784, 796-868, 879-880, 885-891, 922-929, 945-952, 967-1094, 1099, 1126-1129, 1134-1146, 1151-1170, 1175-1210, 1220-1227, 1232-1281, 1290-1313
app/services/neo4j/ecs_ingest.py          268    256    156      0   2.83%   14-26, 31-33, 38-42, 47-51, 56-71, 76-85, 90-405
app/services/neo4j/ingest.py              152    138     80      0   6.03%   10-11, 35-43, 67-80, 85-125, 130-150, 155-159, 187-234, 261-324
app/services/neo4j/internal.py             11      0      0      0 100.00%
app/services/neo4j/models.py              220    152     88      0  22.08%   62, 66, 69-70, 77-85, 89-109, 122, 125-129, 141, 145, 149, 153, 157-162, 187-194, 206-228, 253-271, 284-297, 301-305, 309-313, 320, 324-331, 335-344, 361-370, 381, 385, 389, 393, 397, 401, 405, 409
app/services/neo4j/utils.py                86     72     42      0  10.94%   20-34, 43-44, 49-50, 55, 66-68, 75-77, 89-111, 119-124, 132-159
app/services/opensearch/__init__.py         4      0      0      0 100.00%
app/services/opensearch/analysis.py      1740   1663    790      0   3.04%   142-143, 148-153, 158, 163, 171-204, 209-220, 225-298, 323-364, 371-376, 381, 386, 393-554, 571-758, 784-838, 847-856, 861-868, 876-906, 911-919, 924-945, 950-983, 988-997, 1002-1013, 1018-1047, 1052-1078, 1089-1117, 1129-1188, 1206-1308, 1327-1455, 1487-1668, 1695-1743, 1755-1765, 1792-1899, 1926-1980, 2007-2066, 2093-2146, 2173-2222, 2244-2335, 2369-2430, 2448-2708, 2734-3139, 3165-3355, 3383-3510, 3528-3665, 3702-3880, 3905-3934, 3944-4124, 4131, 4156-4177
app/services/opensearch/client.py         153    133     38      0  10.47%   9-10, 21-26, 38-64, 74-114, 131-138, 143-148, 153-171, 180-200, 205-215, 224-234, 243-256, 261-265, 283-320
app/services/opensearch/index.py           21     12      2      0  39.13%   34-38, 43, 48-77
app/services/opensearch/internal.py         6      0      0      0 100.00%
app/services/opensearch/mappings.py         5      0      0      0 100.00%
app/services/opensearch/query.py          136    126     54      0   5.26%   37-114, 135-186, 207-258, 322-433, 483-517
app/services/opensearch/storage.py        415    397    228      0   2.80%   22-106, 110, 114-129, 133, 144-174, 187-525, 535-556, 561-582, 587-595, 600-603, 628-769
------------------------------------------------------------------------------------
TOTAL                                    5851   5166   2380      1   8.33%
Coverage HTML written to dir htmlcov
1 passed, 42 skipped, 183 deselected in 2.60s
