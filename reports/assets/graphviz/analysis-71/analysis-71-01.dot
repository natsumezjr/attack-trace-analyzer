digraph {
    rankdir=TD;
    node [style="filled,rounded", fontname="Arial"];
    edge [fontname="Arial", fontsize=10];

    Input [label="输入\ntarget.node_uid + time window", fillcolor="#fce4ec"];
    Neo4j [label="Neo4j 查询\n1-hop incident edges", fillcolor="#e3f2fd"];
    Filter [label="时间窗过滤\nstart_ts ≤ ts_float ≤ end_ts", fillcolor="#fff3e0"];
    Process [label="锚点与段划分\n当前: 不划分", fillcolor="#fff3e0"];
    Score [label="风险评分\nseverity / alarm / default", fillcolor="#fff3e0"];
    Sort [label="排序与同分处理\nts_float + src_uid + dst_uid", fillcolor="#fff3e0"];
    Output [label="输出结果\n稳定有序的边序列", fillcolor="#fce4ec"];

    Input -> Neo4j;
    Neo4j -> Filter;
    Filter -> Process;
    Process -> Score;
    Score -> Sort;
    Sort -> Output;
}
